<div class="game-load-screen">
    <button class="close-btn" onclick="goBackToLauncher()">&times;</button>
    <div class="loading-text">Loading Game...</div>
    <button class="start-btn" onclick="startGame()">START</button>

    <!-- Clear button -->
    <button class="debug-btn" onclick="clearUserProgress()" >
        Clear All Data
    </button>
</div>

<script>
// Auto-show debug info when page loads
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        if (window.app && window.app.userProgress) {
            showDebugInfo();
        }
    }, 500); // Wait for app initialization
});


function clearUserProgress() {
    console.log('ðŸ§¹ Debug: Button clicked');
    if (window.app && window.app.userProgress) {
        console.log('ðŸ§¹ Debug: About to call clearProgress');
        window.app.userProgress.clearProgress();
        console.log('ðŸ§¹ Debug: clearProgress completed');

        // Refresh the display
        showDebugInfo();
    }
}

function showDebugInfo() {
    const debugDiv = document.getElementById('debugInfo');
    if (!debugDiv) {
        // Create debug div if it doesn't exist
        const div = document.createElement('div');
        div.id = 'debugInfo';
        div.style.cssText = `position: absolute; bottom: 80px; left: 20px; right: 20px;
                background: rgba(0,0,0,0.9); color: #00ff00; padding: 15px;
                font-family: monospace; font-size: 11px;
                max-height: 50vh; overflow-y: auto; border: 1px solid #00ff00;
                border-radius: 5px;`;
        document.querySelector('.game-load-screen').appendChild(div);
    }

    const userProgress = window.app.userProgress;
    const debugInfo = userProgress.getDebugInfo();
    const progressData = userProgress.getCurrentData();
    const sessionData = userProgress.sessionData;

    let html = '<strong style="color: #ffff00;">===== DEBUG INFO =====</strong><br><br>';

    // Progress overview
    html += '<strong style="color: #00ffff;">ðŸ“Š PROGRESS:</strong><br>';
    const totalPhrases = Object.keys(progressData.phraseProgress).length;
    const masteredPhrases = Object.values(progressData.phraseProgress).filter(p => p.level === 'mastered').length;

    html += `Total Phrases: ${totalPhrases} | Mastered: ${masteredPhrases}<br><br>`;

    // Text and phrase levels
    html += '<strong style="color: #00ffff;">ðŸ“š LEVELS:</strong><br>';
    const textGroups = {};
    Object.entries(progressData.phraseProgress).forEach(([phraseId, data]) => {
        const textId = phraseId.substring(0, phraseId.lastIndexOf('_'));
        if (!textGroups[textId]) textGroups[textId] = [];
        textGroups[textId].push({ phraseId, level: data.level });
    });

    Object.entries(textGroups).forEach(([textId, phrases]) => {
        const textLevel = progressData.textLevels?.[textId] || 1;
        html += `${textId} (L${textLevel}): `;
        html += phrases.map(p => {
            const pNum = p.phraseId.split('_')[2];
            return `${pNum}:${p.level === 'mastered' ? 'M' : p.level}`;
        }).join(', ');
        html += '<br>';
    });

    html += '<br><strong>Press Debug Button to Clear All Data</strong>';

    document.getElementById('debugInfo').innerHTML = html;
}

// Auto-refresh every 2 seconds
setInterval(() => {
    if (window.app && window.app.userProgress) {
        showDebugInfo();
    }
}, 2000);


</script>
